import{j as t}from"./query-DJ2Df_pl.js";import{r as u}from"./react-fVXvAP8Z.js";import{C as m,H as j,T as f,E as y,D as T,a as v,U as C,b as S,c,d as g,e as k,f as w,I as D,g as h}from"./PurchasedTable.styles-DFAhQoT-.js";import{u as I,y as U,a as E,O as P}from"./index-CtR4jyxL.js";import{P as L}from"./CreditsPage-Bwy9BWTM.js";import"./i18n-kcDNZBP3.js";import"./login_background_2-B25p5Ake.js";const p=[{key:"credits",label:"Credits"},{key:"invoice",label:"Invoice"},{key:"date",label:"Purchase date",sortable:!0},{key:"exp",label:"Expiration",sortable:!0}];function H({rows:i=[]}){const[r,l]=u.useState(null),[n,a]=u.useState("asc"),d=u.useMemo(()=>r?[...i].sort((e,s)=>{const o=r==="date"?new Date(e.date):new Date(e.exp),x=r==="date"?new Date(s.date):new Date(s.exp);return n==="asc"?o.getTime()-x.getTime():x.getTime()-o.getTime()}):i,[i,r,n]),b=e=>{r===e?a(s=>s==="asc"?"desc":"asc"):(l(e),a("asc"))};return t.jsxs(m,{children:[t.jsxs(j,{children:[t.jsx(f,{children:"Purchased credits"}),t.jsx(y,{"aria-label":"Download",children:t.jsx(T,{size:20,"aria-hidden":!0})})]}),t.jsxs(v,{children:[t.jsx("span",{id:"purchased-credits-desc",style:{position:"absolute",left:-9999},"aria-hidden":!0,children:"List of purchased credits with invoice reference, purchase date, and expiration."}),t.jsxs(C,{role:"table","aria-label":"Purchased credits","aria-describedby":"purchased-credits-desc",children:[p.map((e,s)=>t.jsx("uui-table-column",{},s)),t.jsx(S,{children:p.map(e=>{const s=e.key==="date"||e.key==="exp",o=r===e.key;return t.jsx("uui-table-head-cell",{role:"columnheader","clip-text":!0,sortable:s?"":void 0,order:o?n:"",onClick:()=>s&&b(e.key),style:{cursor:s?"pointer":"default"},title:e.label,children:t.jsxs(c,{as:"span",children:[t.jsx(g,{title:e.label,"aria-label":e.label,children:e.label}),s&&t.jsx(k,{size:14,"aria-hidden":!0,style:{transform:o&&n==="desc"?"rotate(180deg)":"none"}})]})},e.key)})}),d.map(e=>t.jsxs("uui-table-row",{role:"row",children:[t.jsx("uui-table-cell",{"clip-text":!0,children:t.jsx(c,{children:t.jsx(w,{title:e.credits,"aria-label":e.credits,children:e.credits})})}),t.jsx("uui-table-cell",{"clip-text":!0,children:t.jsx(c,{children:e.invoice?t.jsx(D,{href:"#",title:e.invoice,"aria-label":e.invoice,children:e.invoice}):t.jsx(h,{title:"—","aria-label":"No invoice",children:"—"})})}),t.jsx("uui-table-cell",{"clip-text":!0,children:t.jsx(c,{children:t.jsx(h,{title:e.date,"aria-label":e.date,children:e.date})})}),t.jsx("uui-table-cell",{"clip-text":!0,children:t.jsx(c,{children:t.jsx(h,{title:e.exp,"aria-label":e.exp,children:e.exp})})})]},`${e.invoice}-${e.date}`))]})]})]})}const M=24;function O(i,r){if(!i||!r)return"—";const l=new Date(Date.UTC(i,r-1,1));return l.setUTCMonth(l.getUTCMonth()+M),l.toLocaleString("en-GB",{month:"long",year:"numeric"})}function K(){const{data:i,isLoading:r,isError:l}=I(P);if(r&&!i)return t.jsx(L,{});const n=(i?.history??[]).filter(a=>(a.purchased??0)>0).sort((a,d)=>(d.year??0)*12+(d.month??0)-((a.year??0)*12+(a.month??0))).slice(0,10).map(a=>({credits:`+ ${E(a.purchased)}`,invoice:"",date:U(a.year,a.month),exp:O(a.year,a.month)}));return t.jsx(H,{rows:r&&!n.length&&!l?[]:n})}export{K as default};
